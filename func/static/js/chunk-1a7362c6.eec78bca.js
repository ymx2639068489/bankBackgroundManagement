(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a7362c6"],{6177:function(t,e,a){},"6b92":function(t,e,a){},"6e78":function(t,e,a){"use strict";a("861d9")},"861d9":function(t,e,a){},aa7e:function(t,e,a){"use strict";a("6177")},b146:function(t,e,a){"use strict";a.d(e,"i",(function(){return r})),a.d(e,"j",(function(){return n})),a.d(e,"k",(function(){return o})),a.d(e,"d",(function(){return i})),a.d(e,"e",(function(){return u})),a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return l})),a.d(e,"a",(function(){return c})),a.d(e,"p",(function(){return d})),a.d(e,"q",(function(){return p})),a.d(e,"n",(function(){return _})),a.d(e,"o",(function(){return f})),a.d(e,"f",(function(){return m})),a.d(e,"g",(function(){return h})),a.d(e,"h",(function(){return b})),a.d(e,"l",(function(){return g})),a.d(e,"m",(function(){return v}));var r=[{value:2,label:"审核通过"},{value:1,label:"等待审核"},{value:0,label:"测试中"},{value:-1,label:"审核失败"}],n={2:"审核通过",1:"等待审核",0:"测试中","-1":"审核失败"},o=[{value:1,label:"存款"},{value:2,label:"贷款"}],i=[{value:0,label:"暂不定义"},{value:1,label:"年利率"},{value:2,label:"月利率"},{value:3,label:"日利率"}],u={0:"暂不定义",1:"年利率",2:"月利率",3:"日利率"},s=[{value:1,label:"筛选配置"},{value:2,label:"资源配置"},{value:3,label:"等待审核"},{value:4,label:"等待开始"}],l={1:"筛选配置",2:"资源配置",3:"等待审核",4:"等待开始"},c=[{value:1,label:"等待审核"},{value:2,label:"审核成功"},{value:-1,label:"审核失败"}],d=[{value:1,label:"正常"},{value:-1,label:"冻结"},{value:0,label:"测试"}],p={1:"正常","-1":"冻结",0:"测试"},_=[{label:"女",value:1},{label:"男",value:2},{label:"未知",value:0}],f={1:"女",2:"男",0:"未知"},m=[{value:1,label:"等待处理"},{value:2,label:"处理成功"},{value:-1,label:"订单失败"}],h={1:"等待处理",2:"处理成功","-1":"订单失败"},b={1:"未支付",2:"支付","-1":"支付失败"},g=[{value:1,label:"等待审核"},{value:2,label:"审核成功"},{value:-1,label:"审核失败"},{value:0,label:"查看所有"}],v={1:"等待审核",2:"审核成功","-1":"审核失败"}},c063:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("sift",{on:{submit:t.submit}}),a("product-list-cpm",{attrs:{list:t.showList},on:{delete:t.deleteProduct,update:t.updateProduct}}),a("page",{attrs:{"total-pages":10*t.totalPages,"index-page":t.indexPage},on:{pageChange:t.pageChange}}),a("update",{ref:"update",attrs:{"current-product":t.currentProduct},on:{submit:t.updateSubmit}})],1)},n=[],o=a("2909"),i=(a("a9e3"),a("a434"),a("99af"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{attrs:{data:t.list}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"发布时间"}},[a("span",[t._v(t._s(t.IsoToDate(e.row.created_at)))])]),a("el-form-item",{attrs:{label:"产品库存"}},[a("span",[t._v(t._s(e.row.product_number))])]),a("el-form-item",{attrs:{label:"上一次更新时间"}},[a("span",[t._v(t._s(t.IsoToDate(e.row.updated_at)))])]),a("el-form-item",{attrs:{label:"产品单价"}},[a("span",[t._v(t._s("￥"+e.row.product_price))])]),a("el-form-item",{attrs:{label:"是否可见"}},[a("el-switch",{attrs:{"active-color":"#13ce66",disabled:""},model:{value:e.row.is_visible,callback:function(a){t.$set(e.row,"is_visible",a)},expression:"props.row.is_visible"}})],1),a("el-form-item",{attrs:{label:"产品利率"}},[a("span",[t._v(t._s(e.row.product_interest_rate+"%"))])]),a("el-form-item",{attrs:{label:"利率类型"}},[a("span",[t._v(t._s(t.interest_rate_type_options_map[e.row.interest_rate_type]))])]),a("el-form-item",{attrs:{label:"审核状态"}},[a("span",[t._v(t._s(t.product_status_options_map[e.row.audit_status]))])]),2!==e.row.audit_status&&0!==e.row.audit_status?a("el-form-item",{attrs:{label:"原因"}},[a("span",[t._v(t._s(e.row.audit_message))])]):t._e(),a("el-form-item",{attrs:{label:"已售数量"}},[a("span",[t._v(t._s(e.row.sold_number))])]),a("el-form-item",{attrs:{label:"产品权重"}},[a("span",[t._v(t._s(e.row.weights))])])],1),a("p",[a("b",[t._v("产品描述:")]),t._v(" "+t._s(e.row.product_description))])]}}])}),a("el-table-column",{attrs:{prop:"ID",label:"ID",width:"100"}}),a("el-table-column",{attrs:{label:"产品名称",prop:"product_name",width:"250"}}),a("el-table-column",{attrs:{prop:"status",label:"产品状态",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:"1"===e.row.audit_status?"success":"-1"===e.row.audit_status?"warning":"info"}},[t._v(" "+t._s(t.product_status_options_map[e.row.audit_status])+" ")])]}}])}),a("el-table-column",{attrs:{prop:"product_tags",label:"标签",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.product_tags,(function(e){return a("el-tag",{key:e.ID,attrs:{type:"success"}},[t._v(" "+t._s(e.tag_name)+" ")])}))}}])}),a("el-table-column",{attrs:{prop:"weights",label:"权重",width:"100"}}),a("el-table-column",{attrs:{align:"right","min-width":"250"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push("/product/productAdd")}}},[t._v(" 发布新产品 ")]),t._e()]}},{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.handleUpdate(e.$index,e.row)}}},[t._v("更新/查看产品")]),a("el-button",{attrs:{type:"danger"},on:{click:function(a){return t.handleDel(e.$index,e.row)}}},[t._v("删除产品")])]}}])})],1)}),u=[],s=a("b146"),l={props:{list:{type:Array,default:function(){return[]}}},data:function(){return{product_status_options_map:s["j"],product_type_options:s["k"],interest_rate_type_options_map:s["e"]}},methods:{IsoToDate:function(t){return this.$IsoToString(t)},getStatus:function(t){return 1===t?"未审核":2===t?"审核通过":"审核失败"},handleDel:function(t,e){var a=this;this.$confirm("确定删除产品: ".concat(e.product_name,"吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$emit("delete",e)}))},handleUpdate:function(t,e){this.$emit("update",e)}}},c=l,d=(a("e21f"),a("2877")),p=Object(d["a"])(c,i,u,!1,null,"87cf696e",null),_=p.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-pagination",{ref:"page",attrs:{background:"","hide-on-single-page":!0,layout:"prev, pager, next",total:t.totalPages,"current-page":t.$parent.form.page},on:{"update:currentPage":function(e){return t.$set(t.$parent.form,"page",e)},"update:current-page":function(e){return t.$set(t.$parent.form,"page",e)},"current-change":t.handleCurrentChange}})},m=[],h={props:{totalPages:{type:Number,default:0}},methods:{handleCurrentChange:function(t){this.$emit("pageChange",t)}}},b=h,g=(a("aa7e"),Object(d["a"])(b,f,m,!1,null,"e6733496",null)),v=g.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"20px","margin-left":"50px",width:"800px"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.$parent.form}},[a("el-form-item",{attrs:{label:"产品名","label-width":"100px"}},[a("el-input",{attrs:{clearable:"",placeholder:"产品名"},model:{value:t.$parent.form.product_name,callback:function(e){t.$set(t.$parent.form,"product_name",e)},expression:"$parent.form.product_name"}})],1),a("el-form-item",{attrs:{label:"产品状态","label-width":"100px"}},[a("el-select",{attrs:{clearable:"",placeholder:"产品状态"},model:{value:t.$parent.form.audit_status,callback:function(e){t.$set(t.$parent.form,"audit_status",e)},expression:"$parent.form.audit_status"}},t._l(t.product_status_options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"利率类型","label-width":"100px"}},[a("el-select",{attrs:{clearable:"",placeholder:"利率类型"},model:{value:t.$parent.form.interest_rate_type,callback:function(e){t.$set(t.$parent.form,"interest_rate_type",e)},expression:"$parent.form.interest_rate_type"}},t._l(t.interest_rate_type_options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"100px"},attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("点击查询")])],1)],1)],1)},w=[],I={data:function(){return{product_status_options:s["i"],interest_rate_type_options:s["d"]}},methods:{onSubmit:function(){this.$emit("submit")}}},$=I,x=Object(d["a"])($,y,w,!1,null,"73a0d08a",null),k=x.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.dialogVisible?a("el-dialog",{staticStyle:{width:"1500px"},attrs:{title:"更新产品",visible:t.dialogVisible,"before-close":t.handleCloseDialog},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("table",{staticClass:"table-box",staticStyle:{"margin-left":"50px"},attrs:{border:"0"}},[a("tr",{attrs:{height:t.lineHeight}},[a("td",{attrs:{width:t.lableWidth}},[t._v("产品ID")]),a("td",{staticStyle:{"padding-left":"15px"},attrs:{width:t.dataWidth}},[t._v(t._s(t.productInfo.ID))]),a("td",{attrs:{width:t.lableWidth}},[t._v("产品利率类型：")]),a("td",{attrs:{width:t.dataWidth}},[a("el-select",{attrs:{placeholder:"利率类型"},model:{value:t.productInfo.interest_rate_type,callback:function(e){t.$set(t.productInfo,"interest_rate_type",e)},expression:"productInfo.interest_rate_type"}},t._l(t.interest_rate_type_options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),a("tr",{attrs:{height:t.lineHeight}},[a("td",{attrs:{width:t.lableWidth}},[t._v("产品名称: ")]),a("td",{attrs:{width:t.dataWidth}},[a("el-input",{staticClass:"inputs",attrs:{placeholder:"请输入产品名称"},model:{value:t.productInfo.product_name,callback:function(e){t.$set(t.productInfo,"product_name",e)},expression:"productInfo.product_name"}})],1),a("td",{attrs:{width:t.lableWidth}},[t._v("产品单笔价格")]),a("td",{attrs:{width:t.dataWidth}},[a("el-input",{staticClass:"inputs",attrs:{type:"number"},model:{value:t.productInfo.product_price,callback:function(e){t.$set(t.productInfo,"product_price",e)},expression:"productInfo.product_price"}})],1)]),a("tr",{attrs:{height:t.lineHeight}},[a("td",{attrs:{width:t.lableWidth}},[t._v("产品数量")]),a("td",{attrs:{width:t.dataWidth}},[a("el-input",{staticClass:"inputs",attrs:{type:"number"},model:{value:t.productInfo.product_number,callback:function(e){t.$set(t.productInfo,"product_number",e)},expression:"productInfo.product_number"}})],1),a("td",{attrs:{width:t.lableWidth}},[t._v("产品利率(%)")]),a("td",{attrs:{width:t.dataWidth}},[a("el-input",{staticClass:"inputs",attrs:{type:"number"},model:{value:t.productInfo.product_interest_rate,callback:function(e){t.$set(t.productInfo,"product_interest_rate",e)},expression:"productInfo.product_interest_rate"}})],1)]),a("tr",{attrs:{height:t.lineHeight}},[a("td",{attrs:{width:t.lableWidth}},[t._v("最小持有时间")]),a("td",{attrs:{width:t.dataWidth}},[a("el-input",{staticStyle:{width:"130px"},attrs:{type:"number"},model:{value:t.productInfo.min_hold_time.year,callback:function(e){t.$set(t.productInfo.min_hold_time,"year",e)},expression:"productInfo.min_hold_time.year"}}),a("span",[t._v("年")])],1),a("td",[a("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择"},model:{value:t.productInfo.min_hold_time.month,callback:function(e){t.$set(t.productInfo.min_hold_time,"month",e)},expression:"productInfo.min_hold_time.month"}},t._l(12,(function(t){return a("el-option",{key:t,attrs:{label:t-1,value:t-1}})})),1),a("span",[t._v("月")])],1),a("td",[a("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"请选择"},model:{value:t.productInfo.min_hold_time.day,callback:function(e){t.$set(t.productInfo.min_hold_time,"day",e)},expression:"productInfo.min_hold_time.day"}},t._l(32,(function(t){return a("el-option",{key:t,attrs:{label:t-1,value:t-1}})})),1),a("span",[t._v("日")])],1)]),a("tr",{attrs:{height:"120"}},[a("td",{attrs:{width:t.lableWidth}},[t._v("产品标签")]),a("td",[a("el-select",{staticStyle:{width:"87%"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"","value-key":"tag_id",placeholder:"请选择/输入标签"},model:{value:t.currentTag,callback:function(e){t.currentTag=e},expression:"currentTag"}},t._l(t.tagList,(function(t){return a("el-option",{key:t.tag_id,attrs:{label:t.tag_name,value:t}})})),1)],1),a("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"2"}},t._l(t.productInfo.product_tags,(function(e,r){return a("el-tag",{key:r,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return t.handleClose(e)}}},[t._v(" "+t._s(e.tag_name)+" ")])})),1)]),a("tr",{attrs:{height:t.lineHeight}},[a("td",{attrs:{width:t.lableWidth}},[t._v("产品描述")]),a("td",{attrs:{colspan:"3"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:100},placeholder:"请输入内容"},model:{value:t.productInfo.product_description,callback:function(e){t.$set(t.productInfo,"product_description",e)},expression:"productInfo.product_description"}})],1)])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleCloseDialog}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)]):t._e()},S=[],O=a("b85c"),C=(a("d81d"),a("c4c8")),j={props:{currentProduct:{type:Object,default:function(){return{}}}},data:function(){return{dialogVisible:!1,lableWidth:"120px",dataWidth:"150px",lineHeight:"40px",interest_rate_type_options:s["d"],productInfo:this.currentProduct,inputVisible:!1,inputValue:"",tagList:[],currentTag:[]}},watch:{dialogVisible:function(t,e){var a=this;if(t){this.productInfo=JSON.parse(JSON.stringify(this.currentProduct));for(var r=0;r<this.productInfo.product_tags.length;r++)this.productInfo.product_tags[r]={tag_id:this.productInfo.product_tags[r].ID,tag_name:this.productInfo.product_tags[r].tag_name};this.productInfo.min_hold_time={year:parseInt(this.productInfo.min_hold_time.substr(0,4)),month:parseInt(this.productInfo.min_hold_time.substr(5,2)),day:parseInt(this.productInfo.min_hold_time.substr(8,2))},Object(C["d"])().then((function(t){a.tagList=t.List.map((function(t){return{tag_id:t.ID,tag_name:t.tag_name}}))}))}},currentTag:function(t,e){if("string"===typeof t[0]){var a,r=Object(O["a"])(this.productInfo.product_tags);try{for(r.s();!(a=r.n()).done;){var n=a.value;if(console.log(n.tag_name,t[0]),n.tag_name===t[0])return this.currentTag=[],void this.$message("标签已存在")}}catch(s){r.e(s)}finally{r.f()}this.productInfo.product_tags.push({tag_id:0,tag_name:t[0]}),this.currentTag=[]}else if(1===t.length&&0===e.length){var o,i=Object(O["a"])(this.productInfo.product_tags);try{for(i.s();!(o=i.n()).done;){var u=o.value;if(u.tag_name===t[0].tag_name)return this.currentTag=[],void this.$message("标签已存在")}}catch(s){i.e(s)}finally{i.f()}this.productInfo.product_tags.push({tag_id:t[0].tag_id,tag_name:t[0].tag_name}),this.currentTag=[]}}},methods:{submit:function(){var t=this;this.$confirm("确定修改产品信息？").then((function(e){t.$emit("submit",t.productInfo)})).catch((function(t){}))},handleClose:function(t){this.productInfo.product_tags.splice(this.productInfo.product_tags.indexOf(t),1)},handleCloseDialog:function(t){var e=this;this.$confirm("确认关闭？").then((function(a){"function"===typeof t&&t(),e.dialogVisible=!1})).catch((function(t){}))},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick((function(e){t.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var t=this.inputValue;t&&this.productInfo.product_tags.push({tag_id:0,tag_name:t}),this.inputVisible=!1,this.inputValue=""}}},D=j,T=(a("6e78"),Object(d["a"])(D,P,S,!1,null,"441b24b5",null)),N=T.exports,W={components:{sift:k,page:v,update:N,productListCpm:_},data:function(){return{indexPage:1,totalPages:20,showList:[],currentProduct:{},form:{interest_rate_type:"",page:0,pageSize:20,product_name:"",audit_status:""}}},created:function(){this.form.page=this.$store.getters.getProductPage,this.getProductList(this.form)},beforeDestroy:function(){this.$store.commit("cacheData/SET_PRODUCT_PAGE",this.form.page)},methods:{submit:function(){this.form.interest_rate_type=Number(this.form.interest_rate_type),this.form.audit_status=Number(this.form.audit_status),this.getProductList(this.form)},pageChange:function(t){this.form.page=t,this.getProductList(this.form)},getProductList:function(t){var e=this;Object(C["c"])(t).then((function(t){var a;e.totalPages=Math.ceil(t.Total/e.form.pageSize);var r=t.List;(a=e.showList).splice.apply(a,[0,e.showList.length].concat(Object(o["a"])(r)))}))},deleteProduct:function(t){var e=this;Object(C["b"])(t.ID).then((function(t){e.$message.success("删除成功"),e.getProductList(e.form)}))},updateProduct:function(t){this.currentProduct=t,this.$refs.update.dialogVisible=!0},updateSubmit:function(t){var e=this;Object(C["e"])(t).then((function(t){e.$message.success("修改成功"),e.$refs.update.dialogVisible=!1,e.getProductList(e.form)}))}}},L=W,V=Object(d["a"])(L,r,n,!1,null,"bb8f1682",null);e["default"]=V.exports},c4c8:function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"b",(function(){return o})),a.d(e,"e",(function(){return u})),a.d(e,"d",(function(){return s})),a.d(e,"a",(function(){return l}));a("a9e3"),a("d3b7"),a("fb6a"),a("a15b");var r=a("b775");function n(t){t.interest_rate_type=Number(t.interest_rate_type||0),t.audit_status=Number(t.audit_status||0);var e=t.interest_rate_type,a=t.page,n=t.page_size,o=t.product_name,i=t.audit_status;return new Promise((function(t,u){Object(r["a"])({url:"/api/product/all",method:"post",data:JSON.stringify({interest_rate_type:e,page:a,page_size:n,product_name:o,audit_status:i})}).then((function(e){0!==e.code?u(e.msg):t(e.data)}))}))}function o(t){return new Promise((function(e,a){Object(r["a"])({url:"/api/product/delete",method:"delete",data:JSON.stringify({product_id:t})}).then((function(t){0!==t.code?a(t.msg):e(t.data)}))}))}function i(t,e){return(Array(e).join("0")+t).slice(-e)}function u(t){var e=i(t.min_hold_time.year,4)+"-"+i(t.min_hold_time.month,2)+"-"+i(t.min_hold_time.day,2),a={interest_rate_type:t.interest_rate_type,min_hold_time:e,product_description:t.product_description,product_id:t.ID,product_interest_rate:Number(t.product_interest_rate),product_name:t.product_name,product_number:Number(t.product_number),product_price:Number(t.product_price),product_tags:t.product_tags};return console.log(a),new Promise((function(t,e){Object(r["a"])({url:"/api/product/update",method:"put",data:JSON.stringify(a)}).then((function(a){0!==a.code?e(a.msg):t(a.data)}))}))}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return new Promise((function(a,n){Object(r["a"])({url:"/api/product/tag/list",method:"post",data:JSON.stringify({page:t,page_size:e})}).then((function(t){0!==t.code?n(t.msg):a(t.data)}))}))}function l(t){var e=t.min_hold_time,a=t.product_interest_rate,n=t.product_number,o=t.product_price;a=Number(a),n=Number(n),o=Number(o),e=i(e.year,4)+"-"+i(e.month,2)+"-"+i(e.day,2);var u=t.interest_rate_type,s=t.product_description,l=t.product_name,c=t.product_tags;return new Promise((function(t,i){Object(r["a"])({url:"/api/product/release",method:"post",data:JSON.stringify({interest_rate_type:u,min_hold_time:e,product_description:s,product_interest_rate:a,product_name:l,product_number:n,product_price:o,product_tags:c})}).then((function(e){0!==e.code?i(e.msg):t(e.data)}))}))}},e21f:function(t,e,a){"use strict";a("6b92")}}]);